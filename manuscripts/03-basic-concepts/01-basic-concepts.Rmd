class: inverse, middle, center

# Basic concepts illustrated using a two-level factor (pp.3--8)

---

class: inverse, middle
<!-- class: inverse, middle, split-50 -->

## 1要因2水準の実験で，応答変数の平均値を比較

1. シミュレーション用データを作成
2. シミュレーションの結果を図や表で確認
3. シミュレーション用データに対し線形モデルを構築
    - とりあえず線形モデルを作るとどうなるか試す
4. Default contrast coding: treatment contrasts
5. Defining hypotheses
6. Sum contrast
7. Cell means parameterization

---

::::: block

### シミュレーション用データを作成

- [`mixedDesign()`](http://read.psych.uni-potsdam.de/attachments/article/188/mixedDesign.v0.6.3.R)を使う
- 1要因2水準
    1. F1: 0.8秒
    1. F2: 0.4秒
- 実験参加者数10人
  - 被験者間計画 (between-subject design)
  - 実験参加者は，F1の条件だけ，またはF2の条件だけに接する
    1. F1: 5人
    1. F2: 5人

:::::

---

<!--
https://stackoverflow.com/questions/67750561/vertically-scrollable-code-with-rstudio-and-xaringan
-->

`r chunk_reveal("simdat")`

<!--
#### the number of between-subject factors
-->

```{r simdat, include = FALSE}
mixedDesign(
  #### 被験者間計画での水準数 ####
  B = 2,
  #### 被験者内計画での水準数 ####
  W = NULL,
  #### 被験者間計画での1水準あたりの実験参加者数 ####
  #### 実験参加者総数は，`B * n` ####
  n = 5,
  #### 水準ごとの応答変数の平均を示した行列 ####
  #### 各行に水準ごとの応答変数の平均を入れる ####
  M = matrix(
    c(0.8, 0.4),
    nrow = 2,
    ncol = 1,
    byrow = FALSE
  ),
  #### 要因の標準偏差 ####
  SD = 0.20,
  #### 「1試行1データ」の整然データでデータフレームを作成 ####
  long = TRUE
) |>
  rename(F = B_A) |>
  mutate(
    F = case_when(
      F == "A1" ~ "F1",
      F == "A2" ~ "F2",
      TRUE ~ "NA_character_"
    )
  ) -> 
  simdat

str(simdat)
```

---

::::: block

### シミュレーションの結果を図や表で確認

- 1要因2水準
    1. F1: 0.8秒（標準偏差0.2秒）
    1. F2: 0.4秒（標準偏差0.2秒）

:::::

---

`r chunk_reveal("fig-simdat")`

```{r fig-simdat, include = FALSE}
simdat  |>
  group_by(F) |>
  summarise(
    N = length(DV),
    M = mean(DV),
    SD = sd(DV),
    SE = SD / sqrt(N)
  ) |>
  ungroup() |>
  (
    \(d){
      qplot(
        x = F, y = M,
        group = 1,
        data = d,
        geom = c("point", "line")
      )
    }
  )() +
  geom_errorbar(
    aes(
      max = M + SE,
      min = M - SE
    ),
    width = 0
  ) +
  labs(
    y = "Mean DV",
    x = "Factor F"
  )
```

---

`r chunk_reveal("tab-simdat")`

```{r tab-simdat, include = FALSE}
simdat  |>
  group_by(F) |>
  summarise(
    N = length(DV),
    M = mean(DV),
    SD = sd(DV),
    SE = SD / sqrt(N)
  ) |>
  ungroup() |>
  kable(
    digits = 2,
    col.names = c(
      'Levels of Factor',
      'N. of data points',
      'Mean RT',
      'Std. Dev.',
      'Std. Err.'
    )
  )
```

---

::::: block

### シミュレーション用データに対し線形モデルを構築

- 水準間で応答変数の平均が有意に異なるか，線形モデルで確認
- （要因のコーディングを何も考えないで，とりあえず実行）

:::::

---

`r chunk_reveal("lm-simdat")`

```{r lm-simdat}
lm(DV ~ F, simdat) ->
  m_F

m_F |>
  tidy()
```
---

::::: block

### Default contrast coding: treatment contrasts

- 水準間で応答変数の平均が有意に異なるか，線形モデルで確認
- （要因のコーディングを何も考えないで，とりあえず実行）

:::::

---

`r chunk_reveal("lm-simdat")`

```{r}
lm(DV ~ F, simdat) ->
  m_F

m_F |>
  tidy()
```

<!--
5. Defining hypotheses
6. Sum contrast
7. Cell means parameterization
-->
