name: inverting-the-procedure

## Inverting the procedure

- ここまで，仮説行列から対比行列を作ってきた
- ここでは，「対比行列から仮説行列を作るとどうなるか」考える
  - 仮説行列から対比行列を作る際に使った一般化逆行列の意味や，なぜ一般化逆行列が必要なのかが理解できる

---


`r chunk_reveal("inverting-hypo-contr", left_assign = "TRUE", title = "## Inverting the procedure", display_type = c("code", "output", "md"), md = c("Repeated contrastの仮説行列を作成", "仮説行列に一般化逆行列を適用すると，対比行列ができる", "仮説行列に一般化逆行列を適用し，さらにもう1回一般化逆行列を適用すると，仮説行列に戻ってくる  \n  \n**対比行列に一般化逆行列を適用すると，仮説行列が作れる**"))`

```{r}
#| inverting-hypo-contr,
#| include = FALSE

HcRe <- rbind(
  c2vs1 = c(F1 = -1, F2 = 1, F3 = 0),
  c3vs2 = c(F1 = 0, F2 = -1, F3 = 1)
)

HcRe |> hypr::ginv2()

HcRe |>
  hypr::ginv2() |>
  hypr::ginv2()

```

---

## Centered contrastsにおける切片

- 仮説行列の中では，切片の列（ ${H_0}_0$ ）は足し合わせても0にならない
  - 1になる
- 仮説行列の切片の列（ ${H_0}_0$ ）の総計が1になるのは，一般化逆行列を適用して対比行列を作ったときに，対比行列の切片の列に1だけが入るようにするため
- 対比行列の切片の列に1だけが入るようにするのは，切片の解釈を容易にするため

---

`r chunk_reveal("hypotheis-contrast-matrix-center", left_assign = "detect", title = "## Centered contrastsにおける切片", display_type = c("code", "output", "md"), md = c("仮説行列を作成  \n  \n[ここ](#hypotheis-matrix-how-to)で作成した例", "仮説行列", "仮説行列を転置 *transpose*  \n今度は各行が水準，各列が仮説に変わる", "小数表記を分数表記に改める", "列ごとに足し合わせる  \n  \n仮説行列の中では，切片の列（ ${H_0}_0$ ）は足し合わせても0にならない", "仮説行列から…", "対比行列を作成  \n  \n切片の列には，1だけが入っている"))`


```{r}
#| hypotheis-contrast-matrix-center,
#| include = FALSE

HcSum <- rbind(
  cH00 = c(low =  1/3, med =  1/3, hi =  1/3),
  cH01 = c(low =  2/3, med = -1/3, hi = -1/3),
  cH02 = c(low = -1/3, med =  2/3, hi = -1/3)
)

HcSum |>
  t() |>
  fractions()|>
  colSums()

HcSum |>
  hypr::ginv2()
```

---